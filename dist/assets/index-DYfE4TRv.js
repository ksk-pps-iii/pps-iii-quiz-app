(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&l(m)}).observe(document,{childList:!0,subtree:!0});function o(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(t){if(t.ep)return;t.ep=!0;const a=o(t);fetch(t.href,a)}})();const R=document.getElementById("panel-main"),P=document.getElementById("panel-drugs-list"),_=document.getElementById("panel-flashcards");function z(e){R.classList.add("hidden"),P.classList.add("hidden"),_.classList.add("hidden"),e==="main"?R.classList.remove("hidden"):e==="drugs-list"?P.classList.remove("hidden"):e==="flashcards"&&_.classList.remove("hidden")}const J=document.querySelectorAll(".btn-goto-section");function B(){const e=y&&y.length>0&&y.some(n=>n.loadedContent&&n.loadedContent.length>0);J.forEach(n=>{n.disabled=!e})}const b=document.getElementById("area-eventloading"),A=document.getElementById("icon-area-eventload"),U=document.getElementById("txt-area-eventload"),K=document.getElementById("txt-area-eventload-eventremaining");let M=!1;function Q(e,n=null){M||(b.classList.remove("hidden"),b.classList.add("animation-slide-in-y"),b.onanimationend=()=>{b.classList.remove("animation-slide-in-y")},M=!0),e&&(U.textContent=e),n?A.textContent=n:A.textContent="hourglass",K.textContent=Y()}function j(){b.classList.contains("animation-slide-out-y")||M&&(b.classList.add("animation-slide-out-y"),b.onanimationend=()=>{b.classList.remove("animation-slide-out-y"),b.classList.add("hidden")},M=!1)}let S=[],w=!1;async function D(e,n,o=null){if(!e||!n||typeof n!="function")return Promise.reject(new Error("The event parameters are missing"));console.log("Added event : "+e);let l=new Promise((t,a)=>{S.push({name:e,event:n,icon:o,resolve:t,reject:a})});return V(),l}async function V(){if(w!==!0){if(S.length===0){console.log("[#] No events left to process."),j();return}for(w=!0;S.length>0;){const e=S.shift();if(!e||!e.event||typeof e.event!="function"||!e.resolve||!e.reject){console.error("[#] Invalid event in queue founded: Skipping",e),e&&e.reject&&e.reject(new Error("Invalid event in queue founded: Skipping"));continue}console.log("[#] Triggering Event: "+e.name),Q(e.name,e.icon);try{console.log("Got Here");const n=await e.event();e.resolve(n)}catch(n){console.error("Error during event execution ("+e.name+"):",n),e.reject(n)}finally{console.log("[#] Event finished: "+e.name)}}w=!1,console.log("Queue processing finished."),j()}}function Y(){return S.length+(w?1:0)}const X="https://script.google.com/macros/s/AKfycbwiO63v0RvmBAc1THJ6oBD-uy5C-6QS8y48VhEj6sDGg_Ur8bUW4_KUmnPuTOeyjjuSsA/exec";async function W(e,n){const o=JSON.stringify({...n});var l=await fetch(`${X}?action=${e}`,{method:"POST",body:o,headers:{"Content-Type":"text/plain;charset=utf-8"}}),t=await l.json();return t}const N=[{domain:"Number",key:["ลำดับที่(รันอัตโนมัติ)","ลำดับที่"]},{domain:"Generic Name",key:["ชื่อยา"]},{domain:"Class",key:["กลุ่มยา"],isMergedCells:!0,icon:"graph_3"},{domain:"MOA",key:["MOA"],icon:"hov"},{domain:"Indication",key:["Indications"],icon:"medical_services"},{domain:"Regimen",key:["Dosage Regimen"],icon:"lists"},{domain:"Metabolism",key:["Metabolism (ADME)"],icon:"change_circle"},{domain:"Limitations",key:["CrCl/EGFR ที่มีการแนะนำในผู้ป่วยไต (mL/min)"],icon:"warning"},{domain:"ADR",key:["ADRs/DIs ที่สำคัญ (Practical Point) เป็นไปได้อยากให้แบ่งระบบด้วย"],icon:"flash_on"},{domain:"Patient Education",key:["Patient Educations"],icon:"sms"}];function Z(e){var n=e.map((o,l)=>{var t={};for(var a of N){var m=!1;if(a.key)for(var u of a.key)if(o[u]){t[a.domain]=o[u],m=!0;break}else t[a.domain]=null;if(!m&&a.isMergedCells===!0&&a.key)for(var s=l-1;s>=0;s--){let r=!1;for(var u of a.key)if(e[s][u].trim().length>0){t[a.domain]=e[s][u],m=!0,r=!0;break}if(r)break}}return t});return n}function ee(){return Math.floor(1e5+Math.random()*9e5).toString()}let L=[];const T=document.getElementById("modal-container");function O(e){const n=ee(),o=document.createElement("div");o.classList.add("window-modal","panel","area-padding20","area-fit-lim-handheld-90"),o.style.minWidth="30%",o.style.paddingTop="30px";const l=document.createElement("div");l.classList.add("txt-header"),l.textContent=e,o.appendChild(l);const t=document.createElement("button");t.classList.add("btn-modal-close","btn-normal","area-horizontal","area-center","placement-stick-top-right-5"),t.addEventListener("click",()=>te(n));const a=document.createElement("i");a.classList.add("material-symbols-outlined","icon"),a.textContent="close",t.appendChild(a),o.appendChild(t);const m={id:n,name:e,modal:o};return L.push(m),T.appendChild(o),F(),o}function te(e){const n=L.findLastIndex(o=>o.id===e);n<0||(L.splice(n,1).forEach(o=>{o.modal.remove()}),F())}function $(e){const n=L.findLastIndex(o=>o.name===e);n<0||(L.splice(n,1).forEach(o=>{o.modal.remove()}),F())}function F(){if(L.length>0){for(let e=0;e<L.length;e++)if(L[e].modal){if(e===L.length-1){L[e].modal.classList.remove("hidden");continue}L[e].modal.classList.add("hidden")}T.classList.remove("hidden")}else T.classList.add("hidden")}function ne(){var e=O("Sheets");const n=document.createElement("div");n.classList.add("area-horizontal","area-newline"),e.appendChild(n),y.forEach((c,p)=>{if(!c.isLoaded||!c.loadedContent||c.loadedContent.length<=0)return;const d=document.createElement("button");d.classList.add("btn-normal","area-fit-horizontal"),p===0&&(d.dataset.selected=!0,d.classList.add("btn-working","btn-drugs-sheet")),d.dataset.sheet=c.sheet;const i=document.createElement("span");i.classList.add("icon","material-symbols-outlined"),i.textContent="data_table",d.appendChild(i);const h=document.createElement("span");h.textContent=`${c.sheet} (${c.loadedContent.length})`,d.appendChild(h),n.appendChild(d),d.addEventListener("click",()=>{let g=d.dataset.selected==="true";if(g=!g,!g){var x=0;if(document.querySelectorAll(".btn-drugs-sheet").forEach(k=>{k.dataset.selected==="true"&&x++}),x<=1)return}g?(d.dataset.selected=!0,d.classList.add("btn-working")):(d.dataset.selected=!1,d.classList.remove("btn-working"))})});const o=document.createElement("div");o.classList.add("txt-header"),o.textContent="Mode",e.appendChild(o);const l=[],t=document.createElement("div");t.classList.add("area-horizontal","area-newline"),e.appendChild(t);const a=document.createElement("button");a.classList.add("btn-normal","btn-working","area-fit-horizontal"),a.dataset.mode="ordered",a.dataset.selected=!0;const m=document.createElement("span");m.classList.add("icon","material-symbols-outlined"),m.textContent="arrow_forward",a.appendChild(m);const u=document.createElement("span");u.textContent="Ordered",a.appendChild(u),t.appendChild(a);const s=document.createElement("button");s.classList.add("btn-normal","area-fit-horizontal"),s.dataset.mode="randomized",s.dataset.selected=!1;const r=document.createElement("span");r.classList.add("icon","material-symbols-outlined"),r.textContent="shuffle",s.appendChild(r);const E=document.createElement("span");E.textContent="Randomized",s.appendChild(E),t.appendChild(s),l.push(a,s),l.forEach(c=>{c.addEventListener("click",()=>{l.forEach(p=>{p.dataset.selected=!1,p.classList.remove("btn-working")}),c.dataset.selected=!0,c.classList.add("btn-working")})});const v=document.createElement("div");v.style.height="50px",e.appendChild(v);const C=document.createElement("div");C.classList.add("area-horizontal","area-center"),e.appendChild(C);const f=document.createElement("button");f.classList.add("btn-normal","btn-primary","area-fit-horizontal"),f.style.padding="2px 20px !important",f.textContent="Next",C.appendChild(f),f.addEventListener("click",()=>{var c=[];document.querySelectorAll(".btn-drugs-sheet").forEach(i=>{if(i.dataset.selected==="true"&&i.dataset.sheet){var h=y.find(g=>g.sheet===i.dataset.sheet);h&&(c=c.concat(h.loadedContent))}});var p=s.dataset.selected==="true";if(p){var d=[];c.forEach(i=>{const h=Math.floor(Math.random()*(d.length+1));d.splice(h,0,i)}),c=d}$("Sheets"),z("drugs-list"),ae(c)})}function ae(e,n="masonry"){if(document.getElementById("btn-drugs-list-back")?.addEventListener("click",()=>{z("main")}),n==="masonry"){const t=[],a=document.getElementById("area-drugs-list-masonry");a.innerHTML="";const m=oe();for(var o=0;o<m;o++){var l=document.createElement("div");l.classList.add("masonry-column","area-vertical","area-fit-vertical"),l.style.maxWidth=`calc(${1/m*100}% - 10px)`,a.appendChild(l),t.push(l)}e&&e.forEach(u=>{for(var s=t[0],r=s.offsetHeight,E=1;E<t.length;E++){var v=t[E].offsetHeight;v<r&&(s=t[E],r=v)}if(!s)return;var C=document.createElement("div");C.classList.add("masonry-cell","drug-cont");const f=document.createElement("div");f.classList.add("area-fill-horizontal","area-horizontal"),C.appendChild(f);for(var c of N){var p=c.domain,d=u[p];if(d)if(p==="Number"){const i=document.createElement("span");i.classList.add("drug-number"),i.textContent=d,f.appendChild(i)}else if(p==="Generic Name"){const i=document.createElement("span");i.classList.add("drug-generic-name"),i.textContent=d,f.appendChild(i)}else if(p==="Class"){const i=document.createElement("span");i.classList.add("area-horizontal","area-fit-vertical","area-fit-horizontal"),i.textContent=d,i.style.color="#c1c1c1ff",i.style.fontWeight="bold",i.style.fontSize="13px",C.appendChild(i)}else{const i=document.createElement("div");i.classList.add("drug-area-domain");const h=document.createElement("span");h.classList.add("drug-domain");const g=document.createElement("span");g.classList.add("icon","material-symbols-outlined"),g.textContent=c.icon&&c.icon.trim().length>0?c.icon:"hourglass",h.appendChild(g);const x=document.createElement("span");x.textContent=p,h.appendChild(x),i.appendChild(h);const k=document.createElement("span");k.classList.add("drug-content-desc"),k.textContent=d,i.appendChild(k),C.appendChild(i)}}s.appendChild(C)})}}function oe(){const e=window.innerWidth;return e>=1024?4:e>=768?3:e>=640?2:1}function de(){var e=O("Sheets");const n=document.createElement("div");n.classList.add("area-horizontal","area-newline"),e.appendChild(n),y.forEach((c,p)=>{if(!c.isLoaded||!c.loadedContent||c.loadedContent.length<=0)return;const d=document.createElement("button");d.classList.add("btn-normal","area-fit-horizontal"),p===0&&(d.dataset.selected=!0,d.classList.add("btn-working","btn-drugs-sheet")),d.dataset.sheet=c.sheet;const i=document.createElement("span");i.classList.add("icon","material-symbols-outlined"),i.textContent="data_table",d.appendChild(i);const h=document.createElement("span");h.textContent=`${c.sheet} (${c.loadedContent.length})`,d.appendChild(h),n.appendChild(d),d.addEventListener("click",()=>{let g=d.dataset.selected==="true";if(g=!g,!g){var x=0;if(document.querySelectorAll(".btn-drugs-sheet").forEach(k=>{k.dataset.selected==="true"&&x++}),x<=1)return}g?(d.dataset.selected=!0,d.classList.add("btn-working")):(d.dataset.selected=!1,d.classList.remove("btn-working"))})});const o=document.createElement("div");o.classList.add("txt-header"),o.textContent="Mode",e.appendChild(o);const l=[],t=document.createElement("div");t.classList.add("area-horizontal","area-newline"),e.appendChild(t);const a=document.createElement("button");a.classList.add("btn-normal","btn-working","area-fit-horizontal"),a.dataset.mode="ordered",a.dataset.selected=!0;const m=document.createElement("span");m.classList.add("icon","material-symbols-outlined"),m.textContent="arrow_forward",a.appendChild(m);const u=document.createElement("span");u.textContent="Ordered",a.appendChild(u),t.appendChild(a);const s=document.createElement("button");s.classList.add("btn-normal","area-fit-horizontal"),s.dataset.mode="randomized",s.dataset.selected=!1;const r=document.createElement("span");r.classList.add("icon","material-symbols-outlined"),r.textContent="shuffle",s.appendChild(r);const E=document.createElement("span");E.textContent="Randomized",s.appendChild(E),t.appendChild(s),l.push(a,s),l.forEach(c=>{c.addEventListener("click",()=>{l.forEach(p=>{p.dataset.selected=!1,p.classList.remove("btn-working")}),c.dataset.selected=!0,c.classList.add("btn-working")})});const v=document.createElement("div");v.style.height="50px",e.appendChild(v);const C=document.createElement("div");C.classList.add("area-horizontal","area-center"),e.appendChild(C);const f=document.createElement("button");f.classList.add("btn-normal","btn-primary","area-fit-horizontal"),f.style.padding="2px 20px !important",f.textContent="Next",C.appendChild(f),f.addEventListener("click",()=>{var c=[];document.querySelectorAll(".btn-drugs-sheet").forEach(i=>{if(i.dataset.selected==="true"&&i.dataset.sheet){var h=y.find(g=>g.sheet===i.dataset.sheet);h&&(c=c.concat(h.loadedContent))}});var p=s.dataset.selected==="true";if(p){var d=[];c.forEach(i=>{const h=Math.floor(Math.random()*(d.length+1));d.splice(h,0,i)}),c=d}$("Sheets"),z("flashcards"),me(c)})}const I=document.getElementById("flashcard"),H=document.getElementById("flashcard-front"),q=document.getElementById("flashcard-back"),se=document.getElementById("btn-fc-m10"),ie=document.getElementById("btn-fc-m1"),ce=document.getElementById("btn-fc-p1"),le=document.getElementById("btn-fc-p10"),re=document.getElementById("btn-fc-r");function me(e){document.getElementById("btn-flashcards-back").onclick=()=>{z("main")},I.onclick=()=>{I.classList.toggle("is-flipped")};var n=null;const o=l=>{n=n+l,n<0&&(n=e.length-1+n+1),n>e.length-1&&(n%=e.length),H.innerHTML="",q.innerHTML="";const t=document.createElement("div");t.classList.add("area-vertical","area-fit-vertical","area-fit-horizontal"),H.appendChild(t);const a=document.createElement("div");a.classList.add("area-horizontal","area-fit-horizontal"),t.appendChild(a);const m=document.createElement("div");m.classList.add("area-vertical","area-fit-vertical"),q.appendChild(m);for(const s of N)if(s.domain){var u=e[n][s.domain];if(u)if(s.domain==="Number"){const r=document.createElement("span");r.classList.add("drug-number","area-fit-horizontal"),r.textContent=u,r.style.fontSize="24px",a.appendChild(r)}else if(s.domain==="Generic Name"){const r=document.createElement("span");r.classList.add("drug-generic-name"),r.textContent=u,r.style.fontSize="24px",a.appendChild(r)}else if(s.domain==="Class"){const r=document.createElement("span");r.classList.add("area-horizontal","area-fit-vertical","area-fit-horizontal"),r.textContent=u,r.style.color="#c1c1c1ff",r.style.fontWeight="bold",r.style.fontSize="13px",t.appendChild(r)}else{const r=document.createElement("div");r.classList.add("drug-area-domain");const E=document.createElement("span");E.classList.add("drug-domain");const v=document.createElement("span");v.classList.add("icon","material-symbols-outlined"),v.textContent=s.icon&&s.icon.trim().length>0?s.icon:"hourglass",E.appendChild(v);const C=document.createElement("span");C.textContent=s.domain,E.appendChild(C),r.appendChild(E);const f=document.createElement("span");f.classList.add("drug-content-desc"),f.textContent=u,r.appendChild(f),m.appendChild(r)}}I.classList.contains("is-flipped")&&I.classList.toggle("is-flipped")};o(0),ce.onclick=()=>o(1),le.onclick=()=>o(10),ie.onclick=()=>o(-1),se.onclick=()=>o(-10),re.onclick=()=>o(Math.floor(Math.random()*e.length*2)-100)}function G(){const e=O("Drug Sheet Data Source"),n=document.createElement("div");n.classList.add("txt-description"),n.textContent="Please select the specific sheets from the Top Drug Source Sheets collection that you will be using for this session. You can modify these selections at any time by using the Load Sheets button.",e.appendChild(n);const o=document.createElement("div");o.classList.add("area-horizontal","area-newline"),e.appendChild(o),y.length>0&&y.forEach(l=>{const t=document.createElement("button");t.classList.add("btn-normal"),t.style.width="fit-content";const a=document.createElement("span");a.classList.add("material-symbols-outlined","icon"),a.textContent="data_array",t.appendChild(a);const m=document.createElement("span");m.textContent=l.sheet,t.appendChild(m),o.appendChild(t);const u=()=>{l.isLoaded&&l.loadedContent&&l.loadedContent.length>0?(t.classList.remove("btn-candidate"),t.classList.add("btn-success","btn-primary"),a.textContent="data_table"):(t.classList.remove("btn-success","btn-primary"),t.dataset.isCandidateForLoading==="true"?(t.classList.add("btn-candidate","btn-primary"),a.textContent="system_update_alt"):(t.classList.remove("btn-candidate","btn-primary"),a.textContent="data_array"))};u(),t.addEventListener("click",async()=>{t.classList.contains("btn-success")||(t.dataset.isCandidateForLoading=t.dataset.isCandidateForLoading!=="true",D(`Loading the sheet ${l.sheet}`,async()=>{const s=await W("getSheetDrugs",{sheet:l.sheet});l.isLoaded=!0,l.loadedContent=Z(s.data),t.dataset.isCandidateForLoading=!1,B(),u()})),u()})})}let y=null;async function ue(){B(),D("Retrieving the sheet names",async()=>{const e=await W("getSheetNames",{});var n=[...JSON.parse(e.data)];n.forEach(o=>{o.isLoaded=!1,o.isSelected=!1,o.loadedContent=null}),y=n,console.log(n),B()},"label"),D("Initial sheet settings",async()=>{G()},"data_table")}window.onload=await ue;document.getElementById("btn-main-drugs").addEventListener("click",()=>{ne()});document.getElementById("btn-main-flashcards").addEventListener("click",()=>{de()});document.getElementById("btn-setting-load-sheet").addEventListener("click",()=>{G()});
