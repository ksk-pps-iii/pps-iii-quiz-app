(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();const R=document.getElementById("panel-main"),P=document.getElementById("panel-drugs-list"),_=document.getElementById("panel-flashcards");function D(e){R.classList.add("hidden"),P.classList.add("hidden"),_.classList.add("hidden"),e==="main"?R.classList.remove("hidden"):e==="drugs-list"?P.classList.remove("hidden"):e==="flashcards"&&_.classList.remove("hidden")}const J=document.querySelectorAll(".btn-goto-section");function z(){const e=b&&b.length>0&&b.some(a=>a.loadedContent&&a.loadedContent.length>0);J.forEach(a=>{a.disabled=!e})}const x=document.getElementById("area-eventloading"),A=document.getElementById("icon-area-eventload"),U=document.getElementById("txt-area-eventload"),X=document.getElementById("txt-area-eventload-eventremaining");let M=!1;function K(e,a=null){M||(x.classList.remove("hidden"),x.classList.add("animation-slide-in-y"),x.onanimationend=()=>{x.classList.remove("animation-slide-in-y")},M=!0),e&&(U.textContent=e),a?A.textContent=a:A.textContent="hourglass",X.textContent=V()}function j(){x.classList.contains("animation-slide-out-y")||M&&(x.classList.add("animation-slide-out-y"),x.onanimationend=()=>{x.classList.remove("animation-slide-out-y"),x.classList.add("hidden")},M=!1)}let I=[],w=!1;async function B(e,a,o=null){if(!e||!a||typeof a!="function")return Promise.reject(new Error("The event parameters are missing"));console.log("Added event : "+e);let s=new Promise((t,n)=>{I.push({name:e,event:a,icon:o,resolve:t,reject:n})});return Q(),s}async function Q(){if(w!==!0){if(I.length===0){console.log("[#] No events left to process."),j();return}for(w=!0;I.length>0;){const e=I.shift();if(!e||!e.event||typeof e.event!="function"||!e.resolve||!e.reject){console.error("[#] Invalid event in queue founded: Skipping",e),e&&e.reject&&e.reject(new Error("Invalid event in queue founded: Skipping"));continue}console.log("[#] Triggering Event: "+e.name),K(e.name,e.icon);try{console.log("Got Here");const a=await e.event();e.resolve(a)}catch(a){console.error("Error during event execution ("+e.name+"):",a),e.reject(a)}finally{console.log("[#] Event finished: "+e.name)}}w=!1,console.log("Queue processing finished."),j()}}function V(){return I.length+(w?1:0)}const Y="https://script.google.com/macros/s/AKfycbwiO63v0RvmBAc1THJ6oBD-uy5C-6QS8y48VhEj6sDGg_Ur8bUW4_KUmnPuTOeyjjuSsA/exec";async function W(e,a){const o=JSON.stringify({...a});var s=await fetch(`${Y}?action=${e}`,{method:"POST",body:o,headers:{"Content-Type":"text/plain;charset=utf-8"}}),t=await s.json();return t}const O=[{domain:"Number",key:["ลำดับที่(รันอัตโนมัติ)","ลำดับที่"]},{domain:"Generic Name",key:["ชื่อยา"]},{domain:"Class",key:["กลุ่มยา"],isMergedCells:!0,icon:"graph_3"},{domain:"MOA",key:["MOA"],icon:"hov"},{domain:"Indication",key:["Indications"],icon:"medical_services"},{domain:"Regimen",key:["Dosage Regimen"],icon:"lists"},{domain:"Metabolism",key:["Metabolism (ADME)"],icon:"change_circle"},{domain:"Limitations",key:["CrCl/EGFR ที่มีการแนะนำในผู้ป่วยไต (mL/min)"],icon:"warning"},{domain:"ADR",key:["ADRs/DIs ที่สำคัญ (Practical Point) เป็นไปได้อยากให้แบ่งระบบด้วย"],icon:"flash_on"},{domain:"Patient Education",key:["Patient Educations"],icon:"sms"}];function Z(e){var a=e.map((o,s)=>{var t={};for(var n of O){var l=!1;if(n.key)for(var h of n.key)if(o[h]){t[n.domain]=o[h],l=!0;break}else t[n.domain]=null;if(!l&&n.isMergedCells===!0&&n.key)for(var r=s-1;r>=0;r--){let C=!1;for(var h of n.key)if(e[r][h].trim().length>0){t[n.domain]=e[r][h],l=!0,C=!0;break}if(C)break}}return t});return a}function ee(){return Math.floor(1e5+Math.random()*9e5).toString()}let L=[];const T=document.getElementById("modal-container");function N(e){const a=ee(),o=document.createElement("div");o.classList.add("window-modal","panel","area-padding20","area-fit-lim-handheld-90"),o.style.minWidth="30%",o.style.paddingTop="30px";const s=document.createElement("div");s.classList.add("txt-header"),s.textContent=e,o.appendChild(s);const t=document.createElement("button");t.classList.add("btn-modal-close","btn-normal","area-horizontal","area-center","placement-stick-top-right-5"),t.addEventListener("click",()=>te(a));const n=document.createElement("i");n.classList.add("material-symbols-outlined","icon"),n.textContent="close",t.appendChild(n),o.appendChild(t);const l={id:a,name:e,modal:o};return L.push(l),T.appendChild(o),F(),o}function te(e){const a=L.findLastIndex(o=>o.id===e);a<0||(L.splice(a,1).forEach(o=>{o.modal.remove()}),F())}function $(e){const a=L.findLastIndex(o=>o.name===e);a<0||(L.splice(a,1).forEach(o=>{o.modal.remove()}),F())}function F(){if(L.length>0){for(let e=0;e<L.length;e++)if(L[e].modal){if(e===L.length-1){L[e].modal.classList.remove("hidden");continue}L[e].modal.classList.add("hidden")}T.classList.remove("hidden")}else T.classList.add("hidden")}function ne(){var e=N("Sheets");const a=document.createElement("div");a.classList.add("area-horizontal","area-newline"),e.appendChild(a),b.forEach((d,u)=>{if(!d.isLoaded||!d.loadedContent||d.loadedContent.length<=0)return;const i=document.createElement("button");i.classList.add("btn-normal","area-fit-horizontal"),u===0&&(i.dataset.selected=!0,i.classList.add("btn-working","btn-drugs-sheet")),i.dataset.sheet=d.sheet;const c=document.createElement("span");c.classList.add("icon","material-symbols-outlined"),c.textContent="data_table",i.appendChild(c);const g=document.createElement("span");g.textContent=`${d.sheet} (${d.loadedContent.length})`,i.appendChild(g),a.appendChild(i),i.addEventListener("click",()=>{let v=i.dataset.selected==="true";if(v=!v,!v){var k=0;if(document.querySelectorAll(".btn-drugs-sheet").forEach(S=>{S.dataset.selected==="true"&&k++}),k<=1)return}v?(i.dataset.selected=!0,i.classList.add("btn-working")):(i.dataset.selected=!1,i.classList.remove("btn-working"))})});const o=document.createElement("div");o.classList.add("txt-header"),o.textContent="Mode",e.appendChild(o);const s=[],t=document.createElement("div");t.classList.add("area-horizontal","area-newline"),e.appendChild(t);const n=document.createElement("button");n.classList.add("btn-normal","btn-working","area-fit-horizontal"),n.dataset.mode="ordered",n.dataset.selected=!0;const l=document.createElement("span");l.classList.add("icon","material-symbols-outlined"),l.textContent="arrow_forward",n.appendChild(l);const h=document.createElement("span");h.textContent="Ordered",n.appendChild(h),t.appendChild(n);const r=document.createElement("button");r.classList.add("btn-normal","area-fit-horizontal"),r.dataset.mode="randomized",r.dataset.selected=!1;const C=document.createElement("span");C.classList.add("icon","material-symbols-outlined"),C.textContent="shuffle",r.appendChild(C);const f=document.createElement("span");f.textContent="Randomized",r.appendChild(f),t.appendChild(r),s.push(n,r),s.forEach(d=>{d.addEventListener("click",()=>{s.forEach(u=>{u.dataset.selected=!1,u.classList.remove("btn-working")}),d.dataset.selected=!0,d.classList.add("btn-working")})});const m=document.createElement("div");m.style.height="50px",e.appendChild(m);const E=document.createElement("div");E.classList.add("area-horizontal","area-center"),e.appendChild(E);const p=document.createElement("button");p.classList.add("btn-normal","btn-primary","area-fit-horizontal"),p.style.padding="2px 20px !important",p.textContent="Next",E.appendChild(p),p.addEventListener("click",()=>{var d=[];document.querySelectorAll(".btn-drugs-sheet").forEach(c=>{if(c.dataset.selected==="true"&&c.dataset.sheet){var g=b.find(v=>v.sheet===c.dataset.sheet);g&&(d=d.concat(g.loadedContent))}});var u=r.dataset.selected==="true";if(u){var i=[];d.forEach(c=>{const g=Math.floor(Math.random()*(i.length+1));i.splice(g,0,c)}),d=i}$("Sheets"),D("drugs-list"),ae(d)})}function ae(e,a="masonry"){if(document.getElementById("btn-drugs-list-back")?.addEventListener("click",()=>{D("main")}),a==="masonry"){const t=[],n=document.getElementById("area-drugs-list-masonry");n.innerHTML="";const l=oe();for(var o=0;o<l;o++){var s=document.createElement("div");s.classList.add("masonry-column","area-vertical","area-fit-vertical"),s.style.maxWidth=`calc(${1/l*100}% - 10px)`,n.appendChild(s),t.push(s)}e&&e.forEach(h=>{for(var r=t[0],C=r.offsetHeight,f=1;f<t.length;f++){var m=t[f].offsetHeight;m<C&&(r=t[f],C=m)}if(!r)return;var E=document.createElement("div");E.classList.add("masonry-cell","drug-cont");const p=document.createElement("div");p.classList.add("area-fill-horizontal","area-horizontal"),E.appendChild(p);for(var d of O){var u=d.domain,i=h[u];if(i)if(u==="Number"){const c=document.createElement("span");c.classList.add("drug-number"),c.textContent=i,p.appendChild(c)}else if(u==="Generic Name"){const c=document.createElement("span");c.classList.add("drug-generic-name"),c.textContent=i,p.appendChild(c)}else if(u==="Class"){const c=document.createElement("span");c.classList.add("area-horizontal","area-fit-vertical","area-fit-horizontal"),c.textContent=i,c.style.color="#c1c1c1ff",c.style.fontWeight="bold",c.style.fontSize="13px",E.appendChild(c)}else{const c=document.createElement("div");c.classList.add("drug-area-domain");const g=document.createElement("span");g.classList.add("drug-domain");const v=document.createElement("span");v.classList.add("icon","material-symbols-outlined"),v.textContent=d.icon&&d.icon.trim().length>0?d.icon:"hourglass",g.appendChild(v);const k=document.createElement("span");k.textContent=u,g.appendChild(k),c.appendChild(g);const S=document.createElement("span");S.classList.add("drug-content-desc"),S.textContent=i,c.appendChild(S),E.appendChild(c)}}r.appendChild(E)})}}function oe(){const e=window.innerWidth;return e>=1024?4:e>=768?3:e>=640?2:1}function se(){var e=N("Sheets");const a=document.createElement("div");a.classList.add("area-horizontal","area-newline"),e.appendChild(a),b.forEach((d,u)=>{if(!d.isLoaded||!d.loadedContent||d.loadedContent.length<=0)return;const i=document.createElement("button");i.classList.add("btn-normal","area-fit-horizontal"),u===0&&(i.dataset.selected=!0,i.classList.add("btn-working","btn-drugs-sheet")),i.dataset.sheet=d.sheet;const c=document.createElement("span");c.classList.add("icon","material-symbols-outlined"),c.textContent="data_table",i.appendChild(c);const g=document.createElement("span");g.textContent=`${d.sheet} (${d.loadedContent.length})`,i.appendChild(g),a.appendChild(i),i.addEventListener("click",()=>{let v=i.dataset.selected==="true";if(v=!v,!v){var k=0;if(document.querySelectorAll(".btn-drugs-sheet").forEach(S=>{S.dataset.selected==="true"&&k++}),k<=1)return}v?(i.dataset.selected=!0,i.classList.add("btn-working")):(i.dataset.selected=!1,i.classList.remove("btn-working"))})});const o=document.createElement("div");o.classList.add("txt-header"),o.textContent="Mode",e.appendChild(o);const s=[],t=document.createElement("div");t.classList.add("area-horizontal","area-newline"),e.appendChild(t);const n=document.createElement("button");n.classList.add("btn-normal","btn-working","area-fit-horizontal"),n.dataset.mode="ordered",n.dataset.selected=!0;const l=document.createElement("span");l.classList.add("icon","material-symbols-outlined"),l.textContent="arrow_forward",n.appendChild(l);const h=document.createElement("span");h.textContent="Ordered",n.appendChild(h),t.appendChild(n);const r=document.createElement("button");r.classList.add("btn-normal","area-fit-horizontal"),r.dataset.mode="randomized",r.dataset.selected=!1;const C=document.createElement("span");C.classList.add("icon","material-symbols-outlined"),C.textContent="shuffle",r.appendChild(C);const f=document.createElement("span");f.textContent="Randomized",r.appendChild(f),t.appendChild(r),s.push(n,r),s.forEach(d=>{d.addEventListener("click",()=>{s.forEach(u=>{u.dataset.selected=!1,u.classList.remove("btn-working")}),d.dataset.selected=!0,d.classList.add("btn-working")})});const m=document.createElement("div");m.style.height="50px",e.appendChild(m);const E=document.createElement("div");E.classList.add("area-horizontal","area-center"),e.appendChild(E);const p=document.createElement("button");p.classList.add("btn-normal","btn-primary","area-fit-horizontal"),p.style.padding="2px 20px !important",p.textContent="Next",E.appendChild(p),p.addEventListener("click",()=>{var d=[];document.querySelectorAll(".btn-drugs-sheet").forEach(c=>{if(c.dataset.selected==="true"&&c.dataset.sheet){var g=b.find(v=>v.sheet===c.dataset.sheet);g&&(d=d.concat(g.loadedContent))}});var u=r.dataset.selected==="true";if(u){var i=[];d.forEach(c=>{const g=Math.floor(Math.random()*(i.length+1));i.splice(g,0,c)}),d=i}$("Sheets"),D("flashcards"),me(d)})}const y=document.getElementById("flashcard"),H=document.getElementById("flashcard-front"),q=document.getElementById("flashcard-back"),de=document.getElementById("btn-fc-m10"),ie=document.getElementById("btn-fc-m1"),ce=document.getElementById("btn-fc-p1"),le=document.getElementById("btn-fc-p10"),re=document.getElementById("btn-fc-r");function me(e){document.getElementById("btn-flashcards-back").onclick=()=>{D("main")},y.onclick=()=>{y.classList.toggle("is-flipped")},y.draggable=!0;const a=100;var o=null;y.ondragstart=n=>{o=n.clientX},y.ontouchstart=n=>{o=n.touches[0].clientX},y.ondragend=n=>{var l=n.clientX-o;Math.abs(l)>=a&&(l<0?t(1):t(-1))},y.ontouchend=n=>{var l=n.touches[0].clientX-o;Math.abs(l)>=a&&(l<0?t(1):t(-1))};var s=null;const t=n=>{s=s+n,s<0&&(s=e.length-1+s+1),s>e.length-1&&(s%=e.length),H.innerHTML="",q.innerHTML="";const l=document.createElement("div");l.classList.add("area-vertical","area-fit-vertical","area-fit-horizontal"),H.appendChild(l);const h=document.createElement("div");h.classList.add("area-horizontal","area-fit-horizontal"),l.appendChild(h);const r=document.createElement("div");r.classList.add("area-vertical","area-fit-vertical"),q.appendChild(r);for(const f of O)if(f.domain){var C=e[s][f.domain];if(C)if(f.domain==="Number"){const m=document.createElement("span");m.classList.add("drug-number","area-fit-horizontal"),m.textContent=C,m.style.fontSize="24px",h.appendChild(m)}else if(f.domain==="Generic Name"){const m=document.createElement("span");m.classList.add("drug-generic-name"),m.textContent=C,m.style.fontSize="24px",h.appendChild(m)}else if(f.domain==="Class"){const m=document.createElement("span");m.classList.add("area-horizontal","area-fit-vertical","area-fit-horizontal"),m.textContent=C,m.style.color="#c1c1c1ff",m.style.fontWeight="bold",m.style.fontSize="13px",l.appendChild(m)}else{const m=document.createElement("div");m.classList.add("drug-area-domain");const E=document.createElement("span");E.classList.add("drug-domain");const p=document.createElement("span");p.classList.add("icon","material-symbols-outlined"),p.textContent=f.icon&&f.icon.trim().length>0?f.icon:"hourglass",E.appendChild(p);const d=document.createElement("span");d.textContent=f.domain,E.appendChild(d),m.appendChild(E);const u=document.createElement("span");u.classList.add("drug-content-desc"),u.textContent=C,m.appendChild(u),r.appendChild(m)}}y.classList.contains("is-flipped")&&y.classList.toggle("is-flipped")};t(0),ce.onclick=()=>t(1),le.onclick=()=>t(10),ie.onclick=()=>t(-1),de.onclick=()=>t(-10),re.onclick=()=>t(Math.floor(Math.random()*e.length*2)-100)}function G(){const e=N("Drug Sheet Data Source"),a=document.createElement("div");a.classList.add("txt-description"),a.textContent="Please select the specific sheets from the Top Drug Source Sheets collection that you will be using for this session. You can modify these selections at any time by using the Load Sheets button.",e.appendChild(a);const o=document.createElement("div");o.classList.add("area-horizontal","area-newline"),e.appendChild(o),b.length>0&&b.forEach(s=>{const t=document.createElement("button");t.classList.add("btn-normal"),t.style.width="fit-content";const n=document.createElement("span");n.classList.add("material-symbols-outlined","icon"),n.textContent="data_array",t.appendChild(n);const l=document.createElement("span");l.textContent=s.sheet,t.appendChild(l),o.appendChild(t);const h=()=>{s.isLoaded&&s.loadedContent&&s.loadedContent.length>0?(t.classList.remove("btn-candidate"),t.classList.add("btn-success","btn-primary"),n.textContent="data_table"):(t.classList.remove("btn-success","btn-primary"),t.dataset.isCandidateForLoading==="true"?(t.classList.add("btn-candidate","btn-primary"),n.textContent="system_update_alt"):(t.classList.remove("btn-candidate","btn-primary"),n.textContent="data_array"))};h(),t.addEventListener("click",async()=>{t.classList.contains("btn-success")||(t.dataset.isCandidateForLoading=t.dataset.isCandidateForLoading!=="true",B(`Loading the sheet ${s.sheet}`,async()=>{const r=await W("getSheetDrugs",{sheet:s.sheet});s.isLoaded=!0,s.loadedContent=Z(r.data),t.dataset.isCandidateForLoading=!1,z(),h()})),h()})})}let b=null;async function ue(){z(),B("Retrieving the sheet names",async()=>{const e=await W("getSheetNames",{});var a=[...JSON.parse(e.data)];a.forEach(o=>{o.isLoaded=!1,o.isSelected=!1,o.loadedContent=null}),b=a,console.log(a),z()},"label"),B("Initial sheet settings",async()=>{G()},"data_table")}window.onload=await ue;document.getElementById("btn-main-drugs").addEventListener("click",()=>{ne()});document.getElementById("btn-main-flashcards").addEventListener("click",()=>{se()});document.getElementById("btn-setting-load-sheet").addEventListener("click",()=>{G()});
