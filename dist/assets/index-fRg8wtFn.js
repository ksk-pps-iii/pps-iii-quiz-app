(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&d(r)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();const R=document.getElementById("panel-main"),P=document.getElementById("panel-drugs-list"),_=document.getElementById("panel-flashcards");function z(e){R.classList.add("hidden"),P.classList.add("hidden"),_.classList.add("hidden"),e==="main"?R.classList.remove("hidden"):e==="drugs-list"?P.classList.remove("hidden"):e==="flashcards"&&_.classList.remove("hidden")}const J=document.querySelectorAll(".btn-goto-section");function D(){const e=b&&b.length>0&&b.some(a=>a.loadedContent&&a.loadedContent.length>0);J.forEach(a=>{a.disabled=!e})}const y=document.getElementById("area-eventloading"),A=document.getElementById("icon-area-eventload"),U=document.getElementById("txt-area-eventload"),K=document.getElementById("txt-area-eventload-eventremaining");let M=!1;function Q(e,a=null){M||(y.classList.remove("hidden"),y.classList.add("animation-slide-in-y"),y.onanimationend=()=>{y.classList.remove("animation-slide-in-y")},M=!0),e&&(U.textContent=e),a?A.textContent=a:A.textContent="hourglass",K.textContent=V()}function j(){y.classList.contains("animation-slide-out-y")||M&&(y.classList.add("animation-slide-out-y"),y.onanimationend=()=>{y.classList.remove("animation-slide-out-y"),y.classList.add("hidden")},M=!1)}let I=[],w=!1;async function B(e,a,o=null){if(!e||!a||typeof a!="function")return Promise.reject(new Error("The event parameters are missing"));console.log("Added event : "+e);let d=new Promise((t,n)=>{I.push({name:e,event:a,icon:o,resolve:t,reject:n})});return X(),d}async function X(){if(w!==!0){if(I.length===0){console.log("[#] No events left to process."),j();return}for(w=!0;I.length>0;){const e=I.shift();if(!e||!e.event||typeof e.event!="function"||!e.resolve||!e.reject){console.error("[#] Invalid event in queue founded: Skipping",e),e&&e.reject&&e.reject(new Error("Invalid event in queue founded: Skipping"));continue}console.log("[#] Triggering Event: "+e.name),Q(e.name,e.icon);try{console.log("Got Here");const a=await e.event();e.resolve(a)}catch(a){console.error("Error during event execution ("+e.name+"):",a),e.reject(a)}finally{console.log("[#] Event finished: "+e.name)}}w=!1,console.log("Queue processing finished."),j()}}function V(){return I.length+(w?1:0)}const Y="https://script.google.com/macros/s/AKfycbwiO63v0RvmBAc1THJ6oBD-uy5C-6QS8y48VhEj6sDGg_Ur8bUW4_KUmnPuTOeyjjuSsA/exec";async function W(e,a){const o=JSON.stringify({...a});var d=await fetch(`${Y}?action=${e}`,{method:"POST",body:o,headers:{"Content-Type":"text/plain;charset=utf-8"}}),t=await d.json();return t}const O=[{domain:"Number",key:["ลำดับที่(รันอัตโนมัติ)","ลำดับที่"]},{domain:"Generic Name",key:["ชื่อยา"]},{domain:"Class",key:["กลุ่มยา"],isMergedCells:!0,icon:"graph_3"},{domain:"MOA",key:["MOA"],icon:"hov"},{domain:"Indication",key:["Indications"],icon:"medical_services"},{domain:"Regimen",key:["Dosage Regimen"],icon:"lists"},{domain:"Metabolism",key:["Metabolism (ADME)"],icon:"change_circle"},{domain:"Limitations",key:["CrCl/EGFR ที่มีการแนะนำในผู้ป่วยไต (mL/min)"],icon:"warning"},{domain:"ADR",key:["ADRs/DIs ที่สำคัญ (Practical Point) เป็นไปได้อยากให้แบ่งระบบด้วย"],icon:"flash_on"},{domain:"Patient Education",key:["Patient Educations"],icon:"sms"}];function Z(e){var a=e.map((o,d)=>{var t={};for(var n of O){var r=!1;if(n.key)for(var f of n.key)if(o[f]){t[n.domain]=o[f],r=!0;break}else t[n.domain]=null;if(!r&&n.isMergedCells===!0&&n.key)for(var l=d-1;l>=0;l--){let C=!1;for(var f of n.key)if(e[l][f].trim().length>0){t[n.domain]=e[l][f],r=!0,C=!0;break}if(C)break}}return t});return a}function ee(){return Math.floor(1e5+Math.random()*9e5).toString()}let L=[];const T=document.getElementById("modal-container");function N(e){const a=ee(),o=document.createElement("div");o.classList.add("window-modal","panel","area-padding20","area-fit-lim-handheld-90"),o.style.minWidth="30%",o.style.paddingTop="30px";const d=document.createElement("div");d.classList.add("txt-header"),d.textContent=e,o.appendChild(d);const t=document.createElement("button");t.classList.add("btn-modal-close","btn-normal","area-horizontal","area-center","placement-stick-top-right-5"),t.addEventListener("click",()=>te(a));const n=document.createElement("i");n.classList.add("material-symbols-outlined","icon"),n.textContent="close",t.appendChild(n),o.appendChild(t);const r={id:a,name:e,modal:o};return L.push(r),T.appendChild(o),F(),o}function te(e){const a=L.findLastIndex(o=>o.id===e);a<0||(L.splice(a,1).forEach(o=>{o.modal.remove()}),F())}function $(e){const a=L.findLastIndex(o=>o.name===e);a<0||(L.splice(a,1).forEach(o=>{o.modal.remove()}),F())}function F(){if(L.length>0){for(let e=0;e<L.length;e++)if(L[e].modal){if(e===L.length-1){L[e].modal.classList.remove("hidden");continue}L[e].modal.classList.add("hidden")}T.classList.remove("hidden")}else T.classList.add("hidden")}function ne(){var e=N("Sheets");const a=document.createElement("div");a.classList.add("area-horizontal","area-newline"),e.appendChild(a),b.forEach((s,u)=>{if(!s.isLoaded||!s.loadedContent||s.loadedContent.length<=0)return;const i=document.createElement("button");i.classList.add("btn-normal","area-fit-horizontal"),u===0&&(i.dataset.selected=!0,i.classList.add("btn-working","btn-drugs-sheet")),i.dataset.sheet=s.sheet;const c=document.createElement("span");c.classList.add("icon","material-symbols-outlined"),c.textContent="data_table",i.appendChild(c);const g=document.createElement("span");g.textContent=`${s.sheet} (${s.loadedContent.length})`,i.appendChild(g),a.appendChild(i),i.addEventListener("click",()=>{let v=i.dataset.selected==="true";if(v=!v,!v){var x=0;if(document.querySelectorAll(".btn-drugs-sheet").forEach(k=>{k.dataset.selected==="true"&&x++}),x<=1)return}v?(i.dataset.selected=!0,i.classList.add("btn-working")):(i.dataset.selected=!1,i.classList.remove("btn-working"))})});const o=document.createElement("div");o.classList.add("txt-header"),o.textContent="Mode",e.appendChild(o);const d=[],t=document.createElement("div");t.classList.add("area-horizontal","area-newline"),e.appendChild(t);const n=document.createElement("button");n.classList.add("btn-normal","btn-working","area-fit-horizontal"),n.dataset.mode="ordered",n.dataset.selected=!0;const r=document.createElement("span");r.classList.add("icon","material-symbols-outlined"),r.textContent="arrow_forward",n.appendChild(r);const f=document.createElement("span");f.textContent="Ordered",n.appendChild(f),t.appendChild(n);const l=document.createElement("button");l.classList.add("btn-normal","area-fit-horizontal"),l.dataset.mode="randomized",l.dataset.selected=!1;const C=document.createElement("span");C.classList.add("icon","material-symbols-outlined"),C.textContent="shuffle",l.appendChild(C);const h=document.createElement("span");h.textContent="Randomized",l.appendChild(h),t.appendChild(l),d.push(n,l),d.forEach(s=>{s.addEventListener("click",()=>{d.forEach(u=>{u.dataset.selected=!1,u.classList.remove("btn-working")}),s.dataset.selected=!0,s.classList.add("btn-working")})});const m=document.createElement("div");m.style.height="50px",e.appendChild(m);const E=document.createElement("div");E.classList.add("area-horizontal","area-center"),e.appendChild(E);const p=document.createElement("button");p.classList.add("btn-normal","btn-primary","area-fit-horizontal"),p.style.padding="2px 20px !important",p.textContent="Next",E.appendChild(p),p.addEventListener("click",()=>{var s=[];document.querySelectorAll(".btn-drugs-sheet").forEach(c=>{if(c.dataset.selected==="true"&&c.dataset.sheet){var g=b.find(v=>v.sheet===c.dataset.sheet);g&&(s=s.concat(g.loadedContent))}});var u=l.dataset.selected==="true";if(u){var i=[];s.forEach(c=>{const g=Math.floor(Math.random()*(i.length+1));i.splice(g,0,c)}),s=i}$("Sheets"),z("drugs-list"),ae(s)})}function ae(e,a="masonry"){if(document.getElementById("btn-drugs-list-back")?.addEventListener("click",()=>{z("main")}),a==="masonry"){const t=[],n=document.getElementById("area-drugs-list-masonry");n.innerHTML="";const r=oe();for(var o=0;o<r;o++){var d=document.createElement("div");d.classList.add("masonry-column","area-vertical","area-fit-vertical"),d.style.maxWidth=`calc(${1/r*100}% - 10px)`,n.appendChild(d),t.push(d)}e&&e.forEach(f=>{for(var l=t[0],C=l.offsetHeight,h=1;h<t.length;h++){var m=t[h].offsetHeight;m<C&&(l=t[h],C=m)}if(!l)return;var E=document.createElement("div");E.classList.add("masonry-cell","drug-cont");const p=document.createElement("div");p.classList.add("area-fill-horizontal","area-horizontal"),E.appendChild(p);for(var s of O){var u=s.domain,i=f[u];if(i)if(u==="Number"){const c=document.createElement("span");c.classList.add("drug-number"),c.textContent=i,p.appendChild(c)}else if(u==="Generic Name"){const c=document.createElement("span");c.classList.add("drug-generic-name"),c.textContent=i,p.appendChild(c)}else if(u==="Class"){const c=document.createElement("span");c.classList.add("area-horizontal","area-fit-vertical","area-fit-horizontal"),c.textContent=i,c.style.color="#c1c1c1ff",c.style.fontWeight="bold",c.style.fontSize="13px",E.appendChild(c)}else{const c=document.createElement("div");c.classList.add("drug-area-domain");const g=document.createElement("span");g.classList.add("drug-domain");const v=document.createElement("span");v.classList.add("icon","material-symbols-outlined"),v.textContent=s.icon&&s.icon.trim().length>0?s.icon:"hourglass",g.appendChild(v);const x=document.createElement("span");x.textContent=u,g.appendChild(x),c.appendChild(g);const k=document.createElement("span");k.classList.add("drug-content-desc"),k.textContent=i,c.appendChild(k),E.appendChild(c)}}l.appendChild(E)})}}function oe(){const e=window.innerWidth;return e>=1024?4:e>=768?3:e>=640?2:1}function de(){var e=N("Sheets");const a=document.createElement("div");a.classList.add("area-horizontal","area-newline"),e.appendChild(a),b.forEach((s,u)=>{if(!s.isLoaded||!s.loadedContent||s.loadedContent.length<=0)return;const i=document.createElement("button");i.classList.add("btn-normal","area-fit-horizontal"),u===0&&(i.dataset.selected=!0,i.classList.add("btn-working","btn-drugs-sheet")),i.dataset.sheet=s.sheet;const c=document.createElement("span");c.classList.add("icon","material-symbols-outlined"),c.textContent="data_table",i.appendChild(c);const g=document.createElement("span");g.textContent=`${s.sheet} (${s.loadedContent.length})`,i.appendChild(g),a.appendChild(i),i.addEventListener("click",()=>{let v=i.dataset.selected==="true";if(v=!v,!v){var x=0;if(document.querySelectorAll(".btn-drugs-sheet").forEach(k=>{k.dataset.selected==="true"&&x++}),x<=1)return}v?(i.dataset.selected=!0,i.classList.add("btn-working")):(i.dataset.selected=!1,i.classList.remove("btn-working"))})});const o=document.createElement("div");o.classList.add("txt-header"),o.textContent="Mode",e.appendChild(o);const d=[],t=document.createElement("div");t.classList.add("area-horizontal","area-newline"),e.appendChild(t);const n=document.createElement("button");n.classList.add("btn-normal","btn-working","area-fit-horizontal"),n.dataset.mode="ordered",n.dataset.selected=!0;const r=document.createElement("span");r.classList.add("icon","material-symbols-outlined"),r.textContent="arrow_forward",n.appendChild(r);const f=document.createElement("span");f.textContent="Ordered",n.appendChild(f),t.appendChild(n);const l=document.createElement("button");l.classList.add("btn-normal","area-fit-horizontal"),l.dataset.mode="randomized",l.dataset.selected=!1;const C=document.createElement("span");C.classList.add("icon","material-symbols-outlined"),C.textContent="shuffle",l.appendChild(C);const h=document.createElement("span");h.textContent="Randomized",l.appendChild(h),t.appendChild(l),d.push(n,l),d.forEach(s=>{s.addEventListener("click",()=>{d.forEach(u=>{u.dataset.selected=!1,u.classList.remove("btn-working")}),s.dataset.selected=!0,s.classList.add("btn-working")})});const m=document.createElement("div");m.style.height="50px",e.appendChild(m);const E=document.createElement("div");E.classList.add("area-horizontal","area-center"),e.appendChild(E);const p=document.createElement("button");p.classList.add("btn-normal","btn-primary","area-fit-horizontal"),p.style.padding="2px 20px !important",p.textContent="Next",E.appendChild(p),p.addEventListener("click",()=>{var s=[];document.querySelectorAll(".btn-drugs-sheet").forEach(c=>{if(c.dataset.selected==="true"&&c.dataset.sheet){var g=b.find(v=>v.sheet===c.dataset.sheet);g&&(s=s.concat(g.loadedContent))}});var u=l.dataset.selected==="true";if(u){var i=[];s.forEach(c=>{const g=Math.floor(Math.random()*(i.length+1));i.splice(g,0,c)}),s=i}$("Sheets"),z("flashcards"),me(s)})}const S=document.getElementById("flashcard"),H=document.getElementById("flashcard-front"),q=document.getElementById("flashcard-back"),se=document.getElementById("btn-fc-m10"),ie=document.getElementById("btn-fc-m1"),ce=document.getElementById("btn-fc-p1"),le=document.getElementById("btn-fc-p10"),re=document.getElementById("btn-fc-r");function me(e){document.getElementById("btn-flashcards-back").onclick=()=>{z("main")},S.onclick=()=>{S.classList.toggle("is-flipped")},S.draggable=!0;const a=100;var o=null;S.ondragstart=n=>{o=n.clientX},S.ondragend=n=>{var r=n.clientX-o;Math.abs(r)>=a&&(r<0?t(1):t(-1))};var d=null;const t=n=>{d=d+n,d<0&&(d=e.length-1+d+1),d>e.length-1&&(d%=e.length),H.innerHTML="",q.innerHTML="";const r=document.createElement("div");r.classList.add("area-vertical","area-fit-vertical","area-fit-horizontal"),H.appendChild(r);const f=document.createElement("div");f.classList.add("area-horizontal","area-fit-horizontal"),r.appendChild(f);const l=document.createElement("div");l.classList.add("area-vertical","area-fit-vertical"),q.appendChild(l);for(const h of O)if(h.domain){var C=e[d][h.domain];if(C)if(h.domain==="Number"){const m=document.createElement("span");m.classList.add("drug-number","area-fit-horizontal"),m.textContent=C,m.style.fontSize="24px",f.appendChild(m)}else if(h.domain==="Generic Name"){const m=document.createElement("span");m.classList.add("drug-generic-name"),m.textContent=C,m.style.fontSize="24px",f.appendChild(m)}else if(h.domain==="Class"){const m=document.createElement("span");m.classList.add("area-horizontal","area-fit-vertical","area-fit-horizontal"),m.textContent=C,m.style.color="#c1c1c1ff",m.style.fontWeight="bold",m.style.fontSize="13px",r.appendChild(m)}else{const m=document.createElement("div");m.classList.add("drug-area-domain");const E=document.createElement("span");E.classList.add("drug-domain");const p=document.createElement("span");p.classList.add("icon","material-symbols-outlined"),p.textContent=h.icon&&h.icon.trim().length>0?h.icon:"hourglass",E.appendChild(p);const s=document.createElement("span");s.textContent=h.domain,E.appendChild(s),m.appendChild(E);const u=document.createElement("span");u.classList.add("drug-content-desc"),u.textContent=C,m.appendChild(u),l.appendChild(m)}}S.classList.contains("is-flipped")&&S.classList.toggle("is-flipped")};t(0),ce.onclick=()=>t(1),le.onclick=()=>t(10),ie.onclick=()=>t(-1),se.onclick=()=>t(-10),re.onclick=()=>t(Math.floor(Math.random()*e.length*2)-100)}function G(){const e=N("Drug Sheet Data Source"),a=document.createElement("div");a.classList.add("txt-description"),a.textContent="Please select the specific sheets from the Top Drug Source Sheets collection that you will be using for this session. You can modify these selections at any time by using the Load Sheets button.",e.appendChild(a);const o=document.createElement("div");o.classList.add("area-horizontal","area-newline"),e.appendChild(o),b.length>0&&b.forEach(d=>{const t=document.createElement("button");t.classList.add("btn-normal"),t.style.width="fit-content";const n=document.createElement("span");n.classList.add("material-symbols-outlined","icon"),n.textContent="data_array",t.appendChild(n);const r=document.createElement("span");r.textContent=d.sheet,t.appendChild(r),o.appendChild(t);const f=()=>{d.isLoaded&&d.loadedContent&&d.loadedContent.length>0?(t.classList.remove("btn-candidate"),t.classList.add("btn-success","btn-primary"),n.textContent="data_table"):(t.classList.remove("btn-success","btn-primary"),t.dataset.isCandidateForLoading==="true"?(t.classList.add("btn-candidate","btn-primary"),n.textContent="system_update_alt"):(t.classList.remove("btn-candidate","btn-primary"),n.textContent="data_array"))};f(),t.addEventListener("click",async()=>{t.classList.contains("btn-success")||(t.dataset.isCandidateForLoading=t.dataset.isCandidateForLoading!=="true",B(`Loading the sheet ${d.sheet}`,async()=>{const l=await W("getSheetDrugs",{sheet:d.sheet});d.isLoaded=!0,d.loadedContent=Z(l.data),t.dataset.isCandidateForLoading=!1,D(),f()})),f()})})}let b=null;async function ue(){D(),B("Retrieving the sheet names",async()=>{const e=await W("getSheetNames",{});var a=[...JSON.parse(e.data)];a.forEach(o=>{o.isLoaded=!1,o.isSelected=!1,o.loadedContent=null}),b=a,console.log(a),D()},"label"),B("Initial sheet settings",async()=>{G()},"data_table")}window.onload=await ue;document.getElementById("btn-main-drugs").addEventListener("click",()=>{ne()});document.getElementById("btn-main-flashcards").addEventListener("click",()=>{de()});document.getElementById("btn-setting-load-sheet").addEventListener("click",()=>{G()});
